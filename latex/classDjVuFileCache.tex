\hypertarget{classDjVuFileCache}{}\doxysection{Dj\+Vu\+File\+Cache Class Reference}
\label{classDjVuFileCache}\index{DjVuFileCache@{DjVuFileCache}}


{\ttfamily \#include $<$Dj\+Vu\+File\+Cache.\+h$>$}



Inheritance diagram for Dj\+Vu\+File\+Cache\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=166pt]{classDjVuFileCache__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Dj\+Vu\+File\+Cache\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{classDjVuFileCache__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classDjVuFileCache_1_1Item}{Item}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classDjVuFileCache_a6af92c46f5d610524f263769eac1bb4d}{del\+\_\+file}} (const \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $\ast$file)
\item 
void \mbox{\hyperlink{classDjVuFileCache_a3abf73edfb9ba83f561184e855450941}{add\+\_\+file}} (const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&file)
\item 
void \mbox{\hyperlink{classDjVuFileCache_a804c7425b6eaece7708bb1aa35c10f83}{set\+\_\+max\+\_\+size}} (int max\+\_\+size)
\item 
void \mbox{\hyperlink{classDjVuFileCache_a1db78ea450f0e5a939214e09f9ee27dc}{enable}} (bool en)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \mbox{\hyperlink{classDjVuFileCache_a72e182e5d4a08dc8a089dfed55a92c78}{file\+\_\+added}} (const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&file)
\item 
virtual void \mbox{\hyperlink{classDjVuFileCache_a2dc6b8468fa15eee434e89b3337f51f0}{file\+\_\+deleted}} (const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&file)
\item 
virtual void \mbox{\hyperlink{classDjVuFileCache_a990b57f268bd697b87f31796a227fc86}{file\+\_\+cleared}} (const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&file)
\item 
\mbox{\Hypertarget{classDjVuFileCache_a1aa8970683e3d9887abe4e583092f0a2}\label{classDjVuFileCache_a1aa8970683e3d9887abe4e583092f0a2}} 
\mbox{\hyperlink{classGPList}{G\+P\+List}}$<$ \mbox{\hyperlink{classDjVuFileCache_1_1Item}{Item}} $>$ {\bfseries get\+\_\+items} (void)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classDjVuFileCache_a026c80028f2e0597a4bebd3c68f41299}\label{classDjVuFileCache_a026c80028f2e0597a4bebd3c68f41299}} 
\mbox{\hyperlink{classGCriticalSection}{G\+Critical\+Section}} {\bfseries class\+\_\+lock}
\end{DoxyCompactItemize}
\doxysubsection*{Dj\+Vu\+File\+Cache.\+h}
\label{_amgrp2b0ac95fe62f3e912abe5bb6537f82ea}%
Files \#\char`\"{}\+Dj\+Vu\+File\+Cache.\+h\char`\"{}\# and \#\char`\"{}\+Dj\+Vu\+File\+Cache.\+cpp\char`\"{}\# implement a simple caching mechanism for keeping a given number of \textbackslash{}\+Ref\{\mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}}\} instances alive. The cache estimates the size of its elements and gets rid of the oldest ones when necessary.

See \textbackslash{}\+Ref\{\mbox{\hyperlink{classDjVuFileCache}{Dj\+Vu\+File\+Cache}}\} for details.

@memo Simple \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} caching class. \begin{DoxyAuthor}{Author}
Andrei Erofeev \href{mailto:eaf@geocities.com}{\texttt{ eaf@geocities.\+com}} 
\end{DoxyAuthor}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classDjVuFileCache_a2014cdd13b18cea9ecc28c770caa8899}\label{classDjVuFileCache_a2014cdd13b18cea9ecc28c770caa8899}} 
{\bfseries Dj\+Vu\+File\+Cache} (const int max\+\_\+size=5 $\ast$2 $\ast$1024 $\ast$1024)
\item 
static \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFileCache}{Dj\+Vu\+File\+Cache}} $>$ \mbox{\hyperlink{classDjVuFileCache_a15fc04e55e564a01e631bfdb8c0fd711}{create}} (const int max\+\_\+size=5 $\ast$2 $\ast$1024 $\ast$1024)
\item 
void \mbox{\hyperlink{classDjVuFileCache_a46d12cf7d8c684283ba5a518be3fdf11}{clear}} (void)
\item 
int \mbox{\hyperlink{classDjVuFileCache_a46694ef4d725c51dc32b43f758c32f31}{get\+\_\+max\+\_\+size}} (void) const
\item 
bool \mbox{\hyperlink{classDjVuFileCache_a8bf156dfc521dfe8a72a080f859e6c10}{is\+\_\+enabled}} (void) const
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classDjVuFileCache}{Dj\+Vu\+File\+Cache}}\# is a simple list of \textbackslash{}\+Ref\{\mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}}\} instances. It keeps track of the total size of all elements and can get rid of the oldest one once the total size becomes over some threshold. Its main purpose is to keep the added \textbackslash{}\+Ref\{\mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}}\} instances alive until their size exceeds some given threshold (set by \textbackslash{}\+Ref\{set\+\_\+maximum\+\_\+size\}() function). The user is supposed to use \textbackslash{}\+Ref\{Dj\+Vu\+Portcaster\+::name\+\_\+to\+\_\+port\}() to find a file corresponding to a given name. The cache provides no naming services 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classDjVuFileCache_a3abf73edfb9ba83f561184e855450941}\label{classDjVuFileCache_a3abf73edfb9ba83f561184e855450941}} 
\index{DjVuFileCache@{DjVuFileCache}!add\_file@{add\_file}}
\index{add\_file@{add\_file}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{add\_file()}{add\_file()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::add\+\_\+file (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&}]{file }\end{DoxyParamCaption})}

Adds the given file to the cache. It it\textquotesingle{}s already there, its timestamp will be refreshed. \mbox{\Hypertarget{classDjVuFileCache_a46d12cf7d8c684283ba5a518be3fdf11}\label{classDjVuFileCache_a46d12cf7d8c684283ba5a518be3fdf11}} 
\index{DjVuFileCache@{DjVuFileCache}!clear@{clear}}
\index{clear@{clear}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{clear()}{clear()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::clear (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Clears the cache. All items will be deleted. \mbox{\Hypertarget{classDjVuFileCache_a15fc04e55e564a01e631bfdb8c0fd711}\label{classDjVuFileCache_a15fc04e55e564a01e631bfdb8c0fd711}} 
\index{DjVuFileCache@{DjVuFileCache}!create@{create}}
\index{create@{create}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{create()}{create()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFileCache}{Dj\+Vu\+File\+Cache}} $>$ Dj\+Vu\+File\+Cache\+::create (\begin{DoxyParamCaption}\item[{const int}]{max\+\_\+size = {\ttfamily 5$\ast$2$\ast$1024$\ast$1024} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

Constructs the \mbox{\hyperlink{classDjVuFileCache}{Dj\+Vu\+File\+Cache}}\# 
\begin{DoxyParams}{Parameters}
{\em max\+\_\+size} & Maximum allowed size of the cache in bytes. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classDjVuFileCache_a6af92c46f5d610524f263769eac1bb4d}\label{classDjVuFileCache_a6af92c46f5d610524f263769eac1bb4d}} 
\index{DjVuFileCache@{DjVuFileCache}!del\_file@{del\_file}}
\index{del\_file@{del\_file}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{del\_file()}{del\_file()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::del\+\_\+file (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $\ast$}]{file }\end{DoxyParamCaption})}

Removes file \#file\# from the cache \mbox{\Hypertarget{classDjVuFileCache_a1db78ea450f0e5a939214e09f9ee27dc}\label{classDjVuFileCache_a1db78ea450f0e5a939214e09f9ee27dc}} 
\index{DjVuFileCache@{DjVuFileCache}!enable@{enable}}
\index{enable@{enable}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{enable()}{enable()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::enable (\begin{DoxyParamCaption}\item[{bool}]{en }\end{DoxyParamCaption})}

Enables or disables the cache. See \textbackslash{}\+Ref\{is\+\_\+enabled\}() for details 
\begin{DoxyParams}{Parameters}
{\em en} & -\/ If \{{\itshape en\}} is T\+R\+UE, the cache will be enabled. Otherwise it will be disabled. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classDjVuFileCache_a72e182e5d4a08dc8a089dfed55a92c78}\label{classDjVuFileCache_a72e182e5d4a08dc8a089dfed55a92c78}} 
\index{DjVuFileCache@{DjVuFileCache}!file\_added@{file\_added}}
\index{file\_added@{file\_added}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{file\_added()}{file\_added()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::file\+\_\+added (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

This function is called right after the given file has been added to the cache for management. \mbox{\Hypertarget{classDjVuFileCache_a990b57f268bd697b87f31796a227fc86}\label{classDjVuFileCache_a990b57f268bd697b87f31796a227fc86}} 
\index{DjVuFileCache@{DjVuFileCache}!file\_cleared@{file\_cleared}}
\index{file\_cleared@{file\_cleared}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{file\_cleared()}{file\_cleared()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::file\+\_\+cleared (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

This function is called when after the cache decides to get rid of the file. \mbox{\Hypertarget{classDjVuFileCache_a2dc6b8468fa15eee434e89b3337f51f0}\label{classDjVuFileCache_a2dc6b8468fa15eee434e89b3337f51f0}} 
\index{DjVuFileCache@{DjVuFileCache}!file\_deleted@{file\_deleted}}
\index{file\_deleted@{file\_deleted}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{file\_deleted()}{file\_deleted()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::file\+\_\+deleted (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classGP}{GP}}$<$ \mbox{\hyperlink{classDjVuFile}{Dj\+Vu\+File}} $>$ \&}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

This function is called when the given file is no longer managed by the cache. \mbox{\Hypertarget{classDjVuFileCache_a46694ef4d725c51dc32b43f758c32f31}\label{classDjVuFileCache_a46694ef4d725c51dc32b43f758c32f31}} 
\index{DjVuFileCache@{DjVuFileCache}!get\_max\_size@{get\_max\_size}}
\index{get\_max\_size@{get\_max\_size}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{get\_max\_size()}{get\_max\_size()}}
{\footnotesize\ttfamily int Dj\+Vu\+File\+Cache\+::get\+\_\+max\+\_\+size (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Returns the maximum allowed size of the cache. \mbox{\Hypertarget{classDjVuFileCache_a8bf156dfc521dfe8a72a080f859e6c10}\label{classDjVuFileCache_a8bf156dfc521dfe8a72a080f859e6c10}} 
\index{DjVuFileCache@{DjVuFileCache}!is\_enabled@{is\_enabled}}
\index{is\_enabled@{is\_enabled}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{is\_enabled()}{is\_enabled()}}
{\footnotesize\ttfamily bool Dj\+Vu\+File\+Cache\+::is\+\_\+enabled (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Returns \#\+T\+R\+UE\# if the cache is enabled, \#\+F\+A\+L\+SE\# otherwise. When a cache is disabled, \textbackslash{}\+Ref\{add\+\_\+file\}(), and \textbackslash{}\+Ref\{del\+\_\+file\}() do nothing. But the \{{\itshape maximum} size\} is preserved inside the class so that next time the cache is enabled, it will be configured the same way. Clearly this \char`\"{}enable/disable\char`\"{} thing is for convenience only. One could easily simulate this behavior by setting the \{{\itshape maximum} size\} of the cache to \#\+Z\+E\+RO\#. \mbox{\Hypertarget{classDjVuFileCache_a804c7425b6eaece7708bb1aa35c10f83}\label{classDjVuFileCache_a804c7425b6eaece7708bb1aa35c10f83}} 
\index{DjVuFileCache@{DjVuFileCache}!set\_max\_size@{set\_max\_size}}
\index{set\_max\_size@{set\_max\_size}!DjVuFileCache@{DjVuFileCache}}
\doxysubsubsection{\texorpdfstring{set\_max\_size()}{set\_max\_size()}}
{\footnotesize\ttfamily void Dj\+Vu\+File\+Cache\+::set\+\_\+max\+\_\+size (\begin{DoxyParamCaption}\item[{int}]{max\+\_\+size }\end{DoxyParamCaption})}

Sets new maximum size. If the total size of all items in the cache is greater than \#max\+\_\+size\#, the cache will be deleting the oldest items until the size is OK. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
libdjvu/Dj\+Vu\+File\+Cache.\+h\item 
libdjvu/Dj\+Vu\+File\+Cache.\+cpp\end{DoxyCompactItemize}
